# LDAP-credentials-collector-backdoor-generator

Idea About This script
-----------------------
Last year, during external network VAPT of a client i got inside the network using vulnerable web application. Once i was inside, i observed there is an intranet appication which was accessible only if user is having LDAP credentials. 

I got helpdesk LDAP user account and logged into the intranet (its a long story how i managed to get it), also i was having web shell on one server where i got LDAP database dump for organization and started for hash cracking. After my best i could get plain text for only 60% password hashes and my target BIG FISH was still out of my reach (server admin's LDAP account).

After that i made my mind to try something different and simple. Server was not rootable but i was having web shell access on the interanet web portal and included my script to get visitors passwords.

How actually it work
--------------------
This script generate backdoor code which log username password of an user who have passed HTTP basic auth using LDAP credentials. 

If attacker is having web shell access of the website where users are landing after successful HTTP basic authentication via LDAP account, it extract user's username and password from request header (Authorization). 

Attacker need to include the backdoor generated by this script in the website and script will start logging username, password of visitors.

How to use
----------
This script generate one file which we need to upload on target server, include the backdoor file in the webportal which is getting used by users. Backdoor code will extract username password of the user from Authorization header and will log them in a file.

